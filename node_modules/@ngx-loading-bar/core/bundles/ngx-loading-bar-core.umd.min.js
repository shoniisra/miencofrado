!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ngx-loading-bar/core",["exports","@angular/core","@angular/common","rxjs","rxjs/operators"],e):e(((t=t||self)["ngx-loading-bar"]=t["ngx-loading-bar"]||{},t["ngx-loading-bar"].core={}),t.ng.core,t.ng.common,t.rxjs,t.rxjs.operators)}(this,(function(t,e,n,r,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function a(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}var l=function(){function t(t){var e=this;void 0===t&&(t={}),this.config=t,this.state={action:null,value:0,initialValue:0},this.requests=null,this.disabled=!1,this.stream$=new r.Subject,this._value$=null,this.timer$=function(t){var n=r.of(t);switch(t.action){case"start":case"increment":case"set":"start"===t.action&&0===e.config.latencyThreshold&&0===t.value&&(t.value=t.initialValue),e.requests>0&&(n=r.timer(e.config.latencyThreshold,250).pipe(i.map((function(n){return o(o({},t),{value:0===n?e.state.value||t.initialValue:e._increment()})}))));break;case"complete":case"stop":n=0===t.value?r.of(o({},t)):r.timer(0,500).pipe(i.take(2),i.map((function(t){return{value:0===t?100:0}})))}return n.pipe(i.map((function(t){return o(o({},t),{action:"set"})})),i.tap((function(t){return e.next(t,!1)})))},this.config=o({latencyThreshold:0},t)}return Object.defineProperty(t.prototype,"value$",{get:function(){var t=this;return this._value$?this._value$:this._value$=this.stream$.asObservable().pipe(i.startWith(this.state),i.switchMap((function(e){return t.timer$(e)})),i.shareReplay(),i.map((function(t){return t.value})))},enumerable:!0,configurable:!0}),t.prototype.start=function(t){void 0===t&&(t=2),this.disabled||this.next({action:"start",initialValue:t})},t.prototype.stop=function(){this.next({action:"stop"})},t.prototype.complete=function(){this.next({action:"complete"})},t.prototype.disable=function(){this.disabled=!0},t.prototype.set=function(t){this.next({action:"set",value:t})},t.prototype.increment=function(t){void 0===t&&(t=0),this.next({action:"increment",value:t})},t.prototype.next=function(t,e){switch(void 0===e&&(e=!0),t.action){case"start":this.requests=(this.requests||0)+1;break;case"complete":if(this.requests=(this.requests||1)-1,this.requests>0)return;break;case"stop":this.requests=0;break;case"increment":t.value=this._increment(t.value)}this.state=o(o(o({},this.state),{action:null}),t),e&&this.stream$.next(this.state)},t.prototype._increment=function(t){void 0===t&&(t=0);var e=this.state.value;return e>=99&&(t=0),0===t&&(t=e>=0&&e<25?3*Math.random()+3:e>=25&&e<65?3*Math.random():e>=65&&e<90?2*Math.random():e>=90&&e<99?.5:0),t+e},t}(),f=new e.InjectionToken("LOADING_BAR_CONFIG"),d=function(){function t(t,e){var n=this;void 0===e&&(e={}),this.platformId=t,this.config=e,this.refs={},this.streams$=new r.Subject,this.value$=this.streams$.asObservable().pipe(i.startWith(null),i.switchMap((function(){return r.combineLatest.apply(void 0,u(Object.keys(n.refs).map((function(t){return n.refs[t].value$}))))})),i.map((function(t){return Math.max.apply(Math,u([0],t))})))}return Object.defineProperty(t.prototype,"progress$",{get:function(){return this.value$},enumerable:!0,configurable:!0}),t.prototype.start=function(t){void 0===t&&(t=2),this.useRef().start(t)},t.prototype.set=function(t){this.useRef().set(t)},t.prototype.increment=function(t){this.useRef().increment(t)},t.prototype.complete=function(){this.useRef().complete()},t.prototype.stop=function(){this.useRef().stop()},t.prototype.useRef=function(t){return void 0===t&&(t="default"),this.refs[t]||(this.refs[t]=new l(this.config),this.streams$.next(),n.isPlatformBrowser(this.platformId)||this.refs[t].disable()),this.refs[t]},t.ctorParameters=function(){return[{type:Object,decorators:[{type:e.Inject,args:[e.PLATFORM_ID]}]},{type:void 0,decorators:[{type:e.Optional},{type:e.Inject,args:[f]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](e.PLATFORM_ID),e["ɵɵinject"](f,8))},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"}),a(0,e.Inject(e.PLATFORM_ID)),a(1,e.Optional()),a(1,e.Inject(f)),c("design:paramtypes",[Object,Object])],t)}(),h=function(){function t(t){this.loader=t,this.includeSpinner=!0,this.includeBar=!0,this.fixed=!0,this.color="#29d"}return Object.defineProperty(t.prototype,"value$",{get:function(){return this.ref?this.loader.useRef(this.ref).value$:this.loader.value$},enumerable:!0,configurable:!0}),t.ctorParameters=function(){return[{type:d}]},s([e.Input(),c("design:type",Object)],t.prototype,"includeSpinner",void 0),s([e.Input(),c("design:type",Object)],t.prototype,"includeBar",void 0),s([e.Input(),c("design:type",Object)],t.prototype,"fixed",void 0),s([e.Input(),c("design:type",Object)],t.prototype,"color",void 0),s([e.Input(),c("design:type",Number)],t.prototype,"value",void 0),s([e.Input(),c("design:type",String)],t.prototype,"ref",void 0),s([e.Input(),c("design:type",String)],t.prototype,"height",void 0),s([e.Input(),c("design:type",String)],t.prototype,"diameter",void 0),t=s([e.Component({selector:"ngx-loading-bar",template:'\n    <ng-container *ngIf="value != null ? value : (value$ | async) as progress">\n      <div *ngIf="includeSpinner" class="ngx-spinner">\n        <div [style.width]="diameter" [style.height]="diameter" class="ngx-spinner-icon"></div>\n      </div>\n      <div\n        *ngIf="includeBar"\n        class="ngx-bar"\n        [style.background]="color"\n        [style.height]="height"\n        [style.width]="progress + \'%\'"\n      ></div>\n    </ng-container>\n  ',preserveWhitespaces:!1,changeDetection:e.ChangeDetectionStrategy.OnPush,encapsulation:e.ViewEncapsulation.Emulated,host:{"[attr.fixed]":"fixed","[style.color]":"color"},styles:[":host{position:relative;display:block;pointer-events:none}:host .ngx-spinner{transition:350ms linear;display:block;position:absolute;top:5px;left:0}:host .ngx-spinner .ngx-spinner-icon{width:14px;height:14px;border:2px solid transparent;border-top-color:inherit;border-left-color:inherit;border-radius:50%;-webkit-animation:.4s linear infinite loading-bar-spinner;animation:.4s linear infinite loading-bar-spinner}:host .ngx-bar{transition:width 350ms;position:absolute;top:0;left:0;width:100%;height:2px;border-bottom-right-radius:1px;border-top-right-radius:1px}[dir=rtl] :host .ngx-bar{right:0;left:unset}:host[fixed=true]{z-index:10002}:host[fixed=true] .ngx-bar{position:fixed}:host[fixed=true] .ngx-spinner{position:fixed;top:10px;left:10px}[dir=rtl] :host[fixed=true] .ngx-spinner{right:10px;left:unset}@-webkit-keyframes loading-bar-spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}@keyframes loading-bar-spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}"]}),c("design:paramtypes",[d])],t)}(),g=function(){function t(){}return t=s([e.NgModule({imports:[n.CommonModule],declarations:[h],exports:[h]})],t)}();t.LOADING_BAR_CONFIG=f,t.LoadingBarComponent=h,t.LoadingBarModule=g,t.LoadingBarService=d,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-loading-bar-core.umd.min.js.map